<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Login Offline - DL Sistema</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        button {
            background: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0056b3; }
        .result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            white-space: pre-wrap;
            font-family: monospace;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
        }
        .log {
            background: #000;
            color: #00ff00;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Teste Login Offline - DL Sistema</h1>
        
        <div class="test-section info">
            <h3>üéØ Objetivo</h3>
            <p>Testar o fluxo de login sem depender do backend para identificar se o problema est√° no frontend ou backend.</p>
        </div>

        <div class="test-section">
            <h3>üîß Teste 1: Simular Login Vendedor</h3>
            <p>Testando o fluxo completo sem chamar a API:</p>
            <button onclick="testVendedorLogin()">Testar Login Vendedor</button>
            <div id="vendedorResult" class="result"></div>
        </div>

        <div class="test-section">
            <h3>üîß Teste 2: Verificar localStorage</h3>
            <p>Verificando se os dados foram salvos corretamente:</p>
            <button onclick="checkLocalStorage()">Verificar localStorage</button>
            <div id="localStorageResult" class="result"></div>
        </div>

        <div class="test-section">
            <h3>üîß Teste 3: Simular Redirecionamento</h3>
            <p>Testando o redirecionamento para /vendedor:</p>
            <button onclick="testRedirect()">Testar Redirecionamento</button>
            <div id="redirectResult" class="result"></div>
        </div>

        <div class="test-section">
            <h3>üìä Logs de Debug</h3>
            <div id="debugLog" class="log"></div>
        </div>
    </div>

    <script>
        const debugLog = document.getElementById('debugLog');
        
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            debugLog.innerHTML += `[${timestamp}] ${message}\n`;
            debugLog.scrollTop = debugLog.scrollHeight;
            console.log(message);
        }

        function testVendedorLogin() {
            const resultDiv = document.getElementById('vendedorResult');
            log('üîê Iniciando teste de login vendedor...');
            
            try {
                // 1. Simular dados de login
                const userData = {
                    id: 1,
                    nome: 'Vendedor DL',
                    email: 'vendedor@dl.com',
                    username: 'vendedor@dl.com',
                    perfil: 'VENDEDOR',
                    permissoes: ['vendas', 'clientes', 'orcamentos']
                };
                log('‚úÖ Dados do usu√°rio criados');

                // 2. Salvar no localStorage
                localStorage.setItem('auth_token', 'token_' + Date.now());
                localStorage.setItem('perfil_autenticado', 'vendedor');
                localStorage.setItem('user', JSON.stringify(userData));
                log('‚úÖ Dados salvos no localStorage');

                // 3. Determinar destino
                const destination = '/vendedor';
                log(`üéØ Destino determinado: ${destination}`);

                resultDiv.className = 'result success';
                resultDiv.textContent = `‚úÖ Login simulado com sucesso!

üìã Dados do usu√°rio:
- Nome: ${userData.nome}
- Email: ${userData.email}
- Perfil: ${userData.perfil}
- Destino: ${destination}

üéØ Pr√≥ximo passo: Redirecionar para ${destination}`;
                log('‚úÖ Teste de login conclu√≠do com sucesso');

            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `‚ùå Erro no teste de login:\n\n${error.message}`;
                log(`‚ùå Erro no teste de login: ${error.message}`);
            }
        }

        function checkLocalStorage() {
            const resultDiv = document.getElementById('localStorageResult');
            log('üîç Verificando localStorage...');
            
            const token = localStorage.getItem('auth_token');
            const user = localStorage.getItem('user');
            const perfil = localStorage.getItem('perfil_autenticado');
            
            if (token && user && perfil) {
                resultDiv.className = 'result success';
                resultDiv.textContent = `‚úÖ localStorage configurado corretamente:

üîë Token: ${token}
üë§ User: ${user}
üé≠ Perfil: ${perfil}

üìÑ Dados do usu√°rio:
${user}`;
                log('‚úÖ localStorage configurado corretamente');
            } else {
                resultDiv.className = 'result error';
                resultDiv.textContent = `‚ùå localStorage incompleto:

üîë Token: ${token ? 'Presente' : 'Ausente'}
üë§ User: ${user ? 'Presente' : 'Ausente'}
üé≠ Perfil: ${perfil ? 'Presente' : 'Ausente'}`;
                log('‚ùå localStorage incompleto');
            }
        }

        function testRedirect() {
            const resultDiv = document.getElementById('redirectResult');
            log('üîÑ Testando redirecionamento...');
            
            const destination = '/vendedor';
            
            resultDiv.className = 'result success';
            resultDiv.textContent = `‚úÖ Redirecionamento simulado!

üéØ Destino: ${destination}
‚è∞ Redirecionamento em 3 segundos...`;

            log(`üîÑ Redirecionamento simulado para: ${destination}`);
            
            // Simular redirecionamento ap√≥s 3 segundos
            setTimeout(() => {
                log(`üîÑ Executando redirecionamento para: ${destination}`);
                // Em um ambiente real, seria: window.location.href = destination;
                alert(`Redirecionamento simulado para: ${destination}`);
            }, 3000);
        }

        // Executar testes autom√°ticos ao carregar
        window.onload = function() {
            log('üöÄ Iniciando testes offline...');
            setTimeout(testVendedorLogin, 500);
            setTimeout(checkLocalStorage, 1000);
            setTimeout(testRedirect, 1500);
        };
    </script>
</body>
</html> 